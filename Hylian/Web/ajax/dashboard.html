<!--Start Breadcrumb-->
<div class="row">
	<div id="breadcrumb" class="col-xs-12">
		<ol class="breadcrumb">
			<li><a href="index.html">Repository</a></li>
		</ol>
	</div>
</div>
<!--End Breadcrumb-->
<!--Start Dashboard 2-->
<div class="row-fluid">
	<div id="dashboard_tabs" class="col-xs-12 col-sm-10 col-md-12">
		<!--Start Dashboard Tab 4-->

		<!--End Dashboard Tab 4-->
	</div>
	<div class="clearfix"></div>
</div>
<!--End Dashboard 2 -->
<div style="height: 40px;"></div>

<script type="text/javascript">
    $(document).ready(function() {
        var appsNavi;
        var appsRep = [];
        $.getJSON( "http://37.187.9.5:7777/repository/repo.json", function(data) {
            $.ajax({
                url: "http://localhost:8080/getRep",
                async: false,
                dataType: "json",
                success: function (json_data) {
                    appsNavi = jQuery.parseJSON(json_data);
                },
                error: function (e) {
                    alert('Navi Connection Error: ' + e);
                }
			});

            $.each(data, function(key, app) {
                $.each (app, function (key, val) {
                    var installed = '';
                    var enabled = '';
                    var appFound = $.grep(appsNavi.apps, function(app){ return app.id == val.id; });
                    if(appFound.length == 1 ){
                        installed = 'checked=""';
                        if(appFound[0].enabled == 1){
                            enabled = 'checked=""';
                        }
                    }

                    appContainer = '<div class="col-xs-12 col-sm-6 col-md-4 ow-server">' +
                                        '<h4 class="page-header text-right"><i class="fa fa-linux"></i>' + val.name + '</h4>' +
                                        '<div class="row ow-server-bottom">' +
                                            '<div class="col-sm-4 text-center">' +
                                                '<img src="img/' + val.icon + '" class="img-rounded app">' +
                                            '</div>' +
                                            '<div class="col-sm-8">' +
                                                '<div class="row"><i class="fa fa-lock"></i> ' + val.cat + '</div>' +
                                                '<div class="row"><i class="fa fa-clock-o"></i> Uptime - 10 days</div>' +
                                                '<div class="row">' +
                                                    '<div class="col-md-6">' +
                                                        '<div class="toggle-switch toggle-switch-primary">' +
                                                            '<label>' +
                                                                '<input type="checkbox" ' + installed + '" id="install" value="' + val.id + '"></input>' +
                                                                '<div class="toggle-switch-inner" id="install"></div>' +
                                                                '<div class="toggle-switch-switch">' +
                                                                    '<i class="fa fa-check"></i>' +
                                                                '</div>' +
                                                            '</label>' +
                                                        '</div>' +
                                                    '</div>' +
                                                    '<div class="col-md-6">' +
                                                        '<div class="toggle-switch toggle-switch-primary">' +
                                                            '<label>' +
                                                                '<input type="checkbox" ' + enabled + '" id="enable" value="' + val.id + '"></input>' +
                                                                '<div class="toggle-switch-inner" id="enable"></div>' +
                                                                '<div class="toggle-switch-switch">' +
                                                                    '<i class="fa fa-check"></i>' +
                                                                '</div>' +
                                                            '</label>' +
                                                        '</div>' +
                                                    '</div>' +
                                                '</div>' +
                                            '</div>' +
                                        '</div>' +
                                    '</div>';
                    appsRep.push(appContainer);
                });
            });

            $("<div>", {
                "id": "dashboard-servers",
                "class": "row",
                "style": "visibility: visible; position: relative;",
                html: appsRep.join("")
            }).appendTo("#dashboard_tabs");
        });



        $(document).on('click', 'input[type=checkbox]', function(){
            if($(this).is(':checked')){
               console.log((this.id) + " " + $(this).val() + " checked");
            }
            else{
               console.log((this.id) + " " + $(this).val() + " unchecked");
            }
        });

    });

</script>
